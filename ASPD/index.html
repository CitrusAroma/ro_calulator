<link href="https://fonts.googleapis.com/css?family=VT323" rel="stylesheet">
<style>
.act{
width:68px;
height:58px;
text-align:center;
opacity:0;
position:absolute;
top:100px;
left:0px;
line-height:58px;
font-size:24px;
          transition: top 0s ease-out,opaity 0s ease-out,background 0s ease-out;
		  font-family:'VT323';
		  text-shadow: 
     #555 0px 2px,
	 #555 2px 0px,
	 #555 -2px 0px, 
     #555 0px -2px,
	 #555 -1.4px -1.4px,
	 #555 1.4px 1.4px, 
     #555 1.4px -1.4px,
	 #555 -1.4px 1.4px; 
	color:#FFF;
}
.act.criti{
background:url("criti.png") center center no-repeat;
color:#FF0;
}
.act.on{
opacity:1;
top:0px;
z-index:2;
   transition: top 1s ease-out,opacity  0s ease-out,background 0s ease-out,left 2s ease-out;
}
.act.r{
left:150px;
transition: top 3s ease-out,opacity  0s ease-out,background 0s ease-out,left 2.5s ease-out;
}
.act.b{
top:300px;
transition: top 3s ease-out,opacity  1s ease-out,background 0s ease-out,left 2.5s ease-out;
opacity:0;
}

.act.on.sec{
z-index:1;

}
.act_wrap{
position:relative;

height:300px;
}
</style>

<div class="act_wrap">
<div id="act1" class="act">999</div>
<div id="act2" class="act">999</div>
<div id="act3" class="act">999</div>
<div id="act4" class="act">999</div>
<div id="act5" class="act">999</div>
<div id="act6" class="act">999</div>
<div id="act7" class="act">999</div>
<div id="act8" class="act">999</div>
<div id="act9" class="act">999</div>
<div id="act10" class="act">999</div>


</div>
<input id="isCK" type="checkbox"/><br/>
功速<input id="aspd" value="100"/><br/>
暴擊<input id="criti" value="1"/><br/>
<button id="btn">重啟</button><button id="stop">停止</button>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" type="text/javascript"></script>
 <script>
 var isCK=true;
 var criti=98
 var aspd=273.5
 
 var now=1;
 var wait=0;
 var isC=false
 html="";
 
 acts=30
 for(i=1;i<=acts;i++){
 html+='<div id="act'+i+'" class="act">500</div>'
 }
 $(".act_wrap").html(html)
 function loop(){
 timer=setTimeout(function(){
 
  $("#act"+now).addClass("on");
   
  console.log(isCK)
  if(isCK){
  if(now%2==0){
  wait=1000/aspd*100-400/aspd*100+120;
  }else{
  wait=400/aspd*100;
  isC=isCriti(criti/120-0.1);
  
  }
  }else{
  isC=isCriti(criti/120-0.1)
  wait=1000/aspd*100+120;
  }
  if(isC){
  $("#act"+now).addClass("criti");
  $("#act"+now).html("1000")
  }else{
  $("#act"+now).html("500")
  }
  
  var close=now
  
  setTimeout(function(){$("#act"+close).removeClass("on criti sec r b");},2000);
  setTimeout(function(){ $("#act"+close).addClass("sec");},100);
  setTimeout(function(){ $("#act"+close).addClass("r");},300);
  setTimeout(function(){ $("#act"+close).addClass("b");},1000);
  
var audio = new Audio('Critical_Flesh_01.ogg');
	audio.play();
  now++;
  if(now==acts+1)now=1;
  loop();
 },wait);
 

 }
  initalVal()
 loop();
 
 $("#btn").click(function(){
 clearTimeout(timer);
 initalVal()
 loop();
 });
 
 $("#stop").click(function(){
 clearTimeout(timer);
 });
 
 function initalVal(){
  criti=$("#criti").val()
 aspd=$("#aspd").val()
 isCK= $("#isCK:checkbox:checked").length>0;
 
 }
 function isCriti(rate){
 
 var i=Math.random()
 
 if(i<rate)return true;
 else return false;
 
 }
 
 </script>